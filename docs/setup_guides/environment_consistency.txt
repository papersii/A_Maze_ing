# Environment Consistency & Troubleshooting Guide

## 1. 为什么会出现 "Works on my machine" (在我电脑上没问题)？
在多人协作项目中，代码在不同电脑上运行结果不一致通常由以下原因导致：

### A. 配置文件残留 (Configuration Drift)
- **现象**：IDE（IntelliJ/Eclipse）的本地配置文件被提交到了 Git。
- **原因**：每个人的 IDE 设置（SDK 路径、编译器版本、运行配置）可能不同。如果 `.idea/` 文件夹或 `*.iml` 文件被提交，别人的 IDE 会尝试读取你的路径，导致报错。
- **解决方案**：严格的 `.gitignore`（已更新）。**永远不要提交** `.idea/`、`.gradle/`、`build/` 或 `local.properties`。

---

## 2. 解决方案：Local Docker Build (本地 Docker 构建)

由于我们使用 Artemis 作为代码仓库，且为了确保所有人的开发环境一致，我们提供了一键式 Docker 构建脚本。
你**不需要**配置复杂的 Java 环境，只需要安装 Docker。

### 准备工作
- **必须安装**: [Docker Desktop](https://www.docker.com/products/docker-desktop/)
- 安装后启动 Docker Desktop，确保左下角是绿色的 (Engine running)。

### 如何使用 (How to use)

#### Mac / Linux 用户:
在终端运行：
```bash
./docker_build.sh
```

#### Windows 用户:
双击运行项目根目录下的：
```cmd
docker_build.bat
```

### 脚本做了什么？
1. 它会创建一个**纯净的** Linux 环境（Java 17），这个环境和 Artemis 服务器上的环境高度一致。
2. 它会自动下载所有依赖。
3. 它会编译游戏，并将生成的 `.jar` 文件输出到 `docker-build-out/` 文件夹。
4. **如果脚本报错，说明代码本身有问题；如果脚本成功，说明代码是好的。**

---

## 3. 常见报错排查 (Troubleshooting)

### Q: `local.properties` 冲突?
**A:** `local.properties` 包含你本地的 SDK 路径，绝对不能提交。如果 Git 提示该文件有变动，请执行：
```bash
git rm --cached local.properties
```

### Q: 队友的 IntelliJ 爆红，但我的是好的？
**A:** 大概率是因为 `.idea` 文件冲突。
1. 让队友运行 `git clean -fdX` (注意备份，这会删除所有忽略文件)。
2. 或者手动删除项目根目录下的 `.idea` 文件夹，然后重新 Import Project。

---

## 4. 总结
保持一致性的三板斧：
1. **信赖 Docker**：Docker 里的结果就是最终结果。
2. **信赖 Git Ignore**：不要把生成的、本地的配置传上去。
3. **保持环境隔离**：不要手动修改 `gradle-wrapper.properties` 里的版本，除非团队均已同步。
